<!DOCTYPE html><head><meta charset="UTF-8"><title>Radial Return Stress Update | Chamois</title><link rel="icon" type="image/x-icon" href="../../media/chamois_logo.png" sizes="16x16 32x32 64x64 128x128"></link><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/civet_moose.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../contrib/katex/katex.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../../index.html" class="left moose-logo hide-on-med-and-down">Chamois</a><a href="https://github.com/matthiasneuner/chamois" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="../../getting_started.html">Getting Started</a></li><li><a href="../../singularity.html">Singularity container</a></li><li><a href="../../publications.html">Publications</a></li><li><a href="../../contributors.html">Contributors</a></li><li><a href="#!" class="dropdown-trigger" data-target="24373a54-a1fe-4cc9-9826-6f7ed78644e3" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li></ul><a href="#" class="sidenav-trigger" data-target="3d73d732-97c7-4ad1-9743-2142d8feee8a"><i class="material-icons">menu</i></a><ul class="sidenav" id="3d73d732-97c7-4ad1-9743-2142d8feee8a"><li><a href="../../getting_started.html">Getting Started</a></li><li><a href="../../singularity.html">Singularity container</a></li><li><a href="../../publications.html">Publications</a></li><li><a href="../../contributors.html">Contributors</a></li><li><a href="#!" class="dropdown-trigger" data-target="f1081ba1-b01c-453a-aa45-acb7bfa8492c" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div><ul class="dropdown-content" id="24373a54-a1fe-4cc9-9826-6f7ed78644e3"><li><a href="../../syntax/chamois.html">Chamois syntax</a></li></ul><ul class="dropdown-content" id="f1081ba1-b01c-453a-aa45-acb7bfa8492c"><li><a href="../../syntax/chamois.html">Chamois syntax</a></li></ul></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/index.md" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="moose-content col s12 m12 l12"><section id="49cf2a4a-c9ba-4c6b-aced-c79170b53562" data-section-level="1" data-section-text="Radial Return Stress Update"><h1 id="radial-return-stress-update">Radial Return Stress Update</h1><p>Base class which calculates the effective inelastic strain increment required to return the isotropic stress state to a J2 yield surface.  This class is intended to be a parent class for classes with specific constitutive models.</p><section id="90dd7878-8b9b-48af-8dc9-53f9d5d0bb02" data-section-level="3" data-section-text="Algorithm References"><h3 id="algorithm-references">Algorithm References</h3><p>The radial return mapping method, introduced by Simo and Taylor (1985), uses a von Mises yield surface to determine the increment of plastic strain necessary to return the stress state to the yield surface after a trial stress increment takes the computed stress state across the yield surface.  Because the von Mises yield surface in the deviatoric stress space has the shape of a circle, the _plastic correction stress_ is always directed towards the center of the yield surface circle.</p><p>In addition to the <a href="#simo2006computational">Simo and Hughes (2006)</a> textbook, <a href="#dunne2005introduction">Dunne and Petrinic (2005)</a> is an excellent reference for users working with the <code>RadialReturnStressUpdate</code> materials; several of the isotropic plasticity and creep effective plastic strain increment algorithms are taken from <a href="#dunne2005introduction">Dunne and Petrinic (2005)</a>.</p></section><section id="60606fe6-25ad-400b-9903-31c8cba5fed5" data-section-level="3" data-section-text="The Radial Return Stress Update Description"><h3 id="the-radial-return-stress-update-description">The Radial Return Stress Update Description</h3><p>The stress update materials are not called by MOOSE directly but instead only by other materials using the <code>computeProperties</code> method.  For the <code>RadialReturnStressUpdate</code> materials, this calling material is <a href="ComputeMultipleInelasticStress.html">ComputeMultipleInelasticStress</a>.  Separating the call to the stress update materials from MOOSE allows us to iteratively call the stress update materials as is required to achieve convergence.</p></section></section><section id="21a93c69-ffe7-414a-9f4f-42348847ba9d" data-section-level="2" data-section-text="Radial Return Algorithm Overview"><h2 id="radial-return-algorithm-overview">Radial Return Algorithm Overview</h2><div class="card moose-float" style="width:30%;margin-left:2%;float:right"><div class="card-content"><picture class="materialboxed moose-image"><img src="../../media/tensor_mechanics/RadialReturnStressSpace.png"></img></picture><p class="moose-caption"><span class="moose-caption-text">A trial stress is shown outside of the deviatoric yield surface and the radial return                  stress which is normal to the yield surface.</span></p></div></div><p>In this numerical approach, a trial stress is calculated at the start of each simulation time increment; the trial stress calculation assumed all of the new strain increment is elastic strain:</p><p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-22554b9c-7409-4f86-90bc-4f501c48d2c5"></span><script>var element = document.getElementById("moose-equation-22554b9c-7409-4f86-90bc-4f501c48d2c5");katex.render("\\sigma_{trial} = C_{ijkl} \\left( \\Delta \\epsilon_{assumed-elastic} + \\epsilon_{elastic}^{old} \\right)", element, {displayMode:true,throwOnError:false});</script></span></p><p>The algorithms checks to see if the trial stress state is outside of the yield surface, as shown in the figure to the right. If the stress state is outside of the yield surface, the algorithm recomputes the scalar effective inelastic strain required to return the stress state to the yield surface. This approach is given the name Radial Return because the yield surface used is the <a href="https://en.wikipedia.org/wiki/Von_Mises_yield_criterion">von Mises yield surface</a>: in the <a href="https://en.wikipedia.org/wiki/Cauchy_stress_tensor#Stress_deviator_tensor">devitoric stress space</a>, this yield surface has the shape of a circle, and the scalar inelastic strain is assumed to always be directed at the circle center.</p><section id="99cd4aa7-44f3-4595-b3df-11cfd3d8699d" data-section-level="3" data-section-text="Recompute Iterations on the Effective Plastic Strain Increment"><h3 id="recompute-iterations-on-the-effective-plastic-strain-increment">Recompute Iterations on the Effective Plastic Strain Increment</h3><p>The recompute radial return materials each individually calculate, using the <a href="http://mathworld.wolfram.com/NewtonsMethod.html">Newton Method</a>, the amount of effective inelastic strain required to return the stress state to the yield surface.</p><p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-4ed60735-9bdf-4ff5-9b39-070b4cf6aefe"></span><script>var element = document.getElementById("moose-equation-4ed60735-9bdf-4ff5-9b39-070b4cf6aefe");katex.render("\\Delta p^{(t+1)} = \\Delta p^t + d \\Delta p", element, {displayMode:true,throwOnError:false});</script></span></p><p>where the change in the iterative effective inelastic strain is defined as the yield surface over the derivative of the yield surface with respect to the inelastic strain increment. </p><p>In the case of isotropic linear hardening plasticity, with the hardening function <span class="moose-katex-inline-equation" id="moose-equation-796b4648-f7f0-4ee2-adec-b7209e1e51cd"><script>var element = document.getElementById("moose-equation-796b4648-f7f0-4ee2-adec-b7209e1e51cd");katex.render("r = hp", element, {displayMode:false,throwOnError:false});</script></span> , the effective plastic strain increment has the form: <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-3b4ac678-43d8-4baa-806e-e7d019541bb5"></span><script>var element = document.getElementById("moose-equation-3b4ac678-43d8-4baa-806e-e7d019541bb5");katex.render(" d \\Delta p = \\frac{\\sigma^{trial}_{effective} - 3 G \\Delta p - r - \\sigma_{yield}}{3G + h}", element, {displayMode:true,throwOnError:false});</script></span> where G is the isotropic shear modulus, and <span class="moose-katex-inline-equation" id="moose-equation-800b8193-310a-4d41-8ae3-c5c4fb87ad15"><script>var element = document.getElementById("moose-equation-800b8193-310a-4d41-8ae3-c5c4fb87ad15");katex.render("\\sigma^{trial}_{effective}", element, {displayMode:false,throwOnError:false});</script></span> is the scalar von Mises trial stress.</p><p>Once convergence has been reached on the scalar inelastic strain increment, the full inelastic strain tensor is calculated. <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-05d6a72c-c2f3-43bd-bca5-c299adda2a92"></span><script>var element = document.getElementById("moose-equation-05d6a72c-c2f3-43bd-bca5-c299adda2a92");katex.render("\\Delta \\epsilon^{inelastic}_{ij} = \\frac{3}{2} \\Delta p^{(t+1)} \\frac{dev(\\sigma^{trial}_{ij})}{\\sigma^{trial}_{effective}}", element, {displayMode:true,throwOnError:false});</script></span></p><p>The elastic strain is calculated by subtracting the return mapping inelastic strain increment tensor from the mechanical strain tensor.  Mechanical strain is considered as the sum of the elastic and inelastic (plastic, creep, etc) strains. <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-b5099a4b-0efd-4573-a595-9e38417a089e"></span><script>var element = document.getElementById("moose-equation-b5099a4b-0efd-4573-a595-9e38417a089e");katex.render("\\epsilon_{total} = \\epsilon_{mechanical} + \\epsilon_{eigenstrain} = \\left( \\epsilon_{elastic} + \\epsilon_{inelastic} \\right) + \\epsilon_{eigenstrain} = \\epsilon_{elastic} + \\left( \\epsilon_{plastic} + \\epsilon_{creep} + \\epsilon_{damage}  \\right) + \\epsilon_{eigenstrain}", element, {displayMode:true,throwOnError:false});</script></span></p><p>The final inelastic strain is returned from the radial return stress update material, and <code>ComputeMultipleInelasticStress</code> computes the stress, with a return mapping stress increment following elasticity theory for finite strains. The final stress is calculated from the elastic strain increment. <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-952a5e04-7bd7-41d7-9058-87414d32b9c1"></span><script>var element = document.getElementById("moose-equation-952a5e04-7bd7-41d7-9058-87414d32b9c1");katex.render("\\sigma^{new}_{ij} = C_{ijkl} \\left( \\Delta \\epsilon^{elastic}_{kl} + \\epsilon^{old-elastic}_{kl} \\right)", element, {displayMode:true,throwOnError:false});</script></span></p><p>When more than one radial recompute material is included in the simulation, as in Combined Power Law Creep and Linear Strain Hardening, <code>ComputeMultipleInelasticStress</code> will iterate over the change in the calculated stress until the return stress has reached a stable value.</p><p>Users can print out any of these strains and stresses using the <code>RankTwoAux</code> as described on the <a href="../../modules/tensor_mechanics/VisualizingTensors.html">Visualizing Tensors</a> page.</p></section></section><section id="2f58ad4e-e5fe-424c-8502-a4ccbaf67ac2" data-section-level="2" data-section-text="Substepping capability"><h2 id="substepping-capability">Substepping capability</h2><p>Regular use of the radial return mapping triggers one instance of the return to the yield surface that spans the entire system wide time step. While the material time step limiter discussed in <a href="ComputeMultipleInelasticStress.html">ComputeMultipleInelasticStress</a> can effectively limit the time step size to achieve the desired convergence or integration error properties, it does so at the expense of global solves and discarded time steps. An alternative to the material time step limiter is &quot;substepping&quot;, which subdivides the current time step into substeps which are solved sequentially within <code>ComputeMultipleInelasticStress</code>.</p><p>To enabled substepping, the user needs to input <code>use_substep = true</code>. Note, not all inelastic models support substepping, but it is expected that this capability to be gradually extended to more models.</p><p>The default way to calculate the number of substeps is to compare the effective elastic strain increment to the <code>max_inelastic_increment</code> and use that ratio to determine the number of substeps. In essence:</p><p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-de47122b-ce06-4281-bf3b-b0c4c57b423c"></span><script>var element = document.getElementById("moose-equation-de47122b-ce06-4281-bf3b-b0c4c57b423c");katex.render("\\text{number of substeps} = \\frac{\\Delta \\epsilon^{\\text{elastic}}}{\\text{max\\_inelastic\\_increment} \\cdot \\text{substep\\_tolerance}}", element, {displayMode:true,throwOnError:false});</script></span></p><p>where <code>substep_strain_tolerance</code> and <code>max_inelastic_increment</code> are user parameters. Alternatively, as a criterion to select the number of substeps, the user can set the flag <code>use_substep_integration_error</code> to true, which will use the following formula:</p><p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-48eb9bcb-c475-401d-a239-fab1e7078c2b"></span><script>var element = document.getElementById("moose-equation-48eb9bcb-c475-401d-a239-fab1e7078c2b");katex.render("\\text{number of substeps} = \\frac{\\Delta \\epsilon^{\\text{elastic}}}{\\text{substep\\_tolerance}}", element, {displayMode:true,throwOnError:false});</script></span></p><p>This latest formula is directly based on the creep numerical integration error. The <code>substep_strain_tolerance</code> can be considered as the maximum creep numerical integration error  allowed by substepping. A value of <span class="moose-katex-inline-equation" id="moose-equation-584399e3-441e-4520-a713-b315dec83a53"><script>var element = document.getElementById("moose-equation-584399e3-441e-4520-a713-b315dec83a53");katex.render("1.0\\cdot10^4", element, {displayMode:false,throwOnError:false});</script></span> will work for many cases. An example of this option looks as follows:</p><pre class="moose-pre"><code class="language-text">
    use_substep = true
    substep_strain_tolerance = 1.0e-4
    use_substep_integration_error = true
</code></pre></section><section id="6aee27db-9246-4e63-8c56-b7b70a4c7c25" data-section-level="2" data-section-text="Writing a New Stress Update Material"><h2 id="writing-a-new-stress-update-material">Writing a New Stress Update Material</h2><p>New radial return models must inherit from <code>RadialReturnStressUpdate</code> and must overwrite the six virtual methods.</p><ul class="browser-default"><li><p><strong>initQpStatefulProperties</strong>: Set the initial values for all new material properties that are not initialized by an input parameter; generally the material properties initialized in this method are all set to zero. </p></li><li><p><strong>computeStressInitialize</strong>: Calculate the initial trial stress state, the yield surface value, and any hardening or softening parameters at the start of the simulation time increment. </p></li><li><p><strong>computeResidual</strong>: In each iteration over the inelastic strain increment, calculate the value of the effective scalar trial stress subtracted by the yield surface function. </p></li><li><p><strong>computeDerivative</strong>: In each iteration over the inelastic strain increment, calculate the derivative of the yield surface function with respect to the inelastic strain increment. </p></li><li><p><strong>iterationFinalize</strong>: Store the value of the inelastic strain increment at the end of each iteration. </p></li><li><p><strong>computeStressFinalize</strong>: Update the stress after convergence on the inelastic strain increment has been reached.</p></li></ul><p>Additionally, new radial return methods must also overwrite a single method from the MOOSE <code>Material</code> class.</p><ul class="browser-default"><li><p><strong>resetQpProperties</strong>: Set the material property used in the iteration, usually <span class="moose-katex-inline-equation" id="moose-equation-c46e7f50-4526-40a0-a063-68ea439c8973"><script>var element = document.getElementById("moose-equation-c46e7f50-4526-40a0-a063-68ea439c8973");katex.render("\\Delta p", element, {displayMode:false,throwOnError:false});</script></span>, to zero at the start the iteration.  This method is necessary to avoid incorrect material property values.</p></li></ul><p>More details on how to write the equivalent yield surface equation for a creep model are given in Dunne and Petrinic.</p><p></p></section><section id="3176b39f-51eb-43ad-bba3-be2f98809eac" data-section-level="2" data-section-text="References"><h2 id="references">References</h2><div class="moose-bibliography"><ol><li id="dunne2005introduction">Fionn Dunne and Nik Petrinic.
<em>Introduction to Computational Plasticity</em>.
Oxford University Press on Demand, 2005.<a href="#043e119e-9e96-4a7f-aa71-32574e98361b" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="043e119e-9e96-4a7f-aa71-32574e98361b"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@book{dunne2005introduction,
    author = "Dunne, Fionn and Petrinic, Nik",
    title = "Introduction to Computational Plasticity",
    year = "2005",
    publisher = "Oxford University Press on Demand"
}
</code></pre></div></div></li><li id="simo2006computational">Juan&nbsp;C Simo and Thomas&nbsp;JR Hughes.
<em>Computational inelasticity</em>.
Volume&nbsp;7.
Springer Science &amp; Business Media, 2006.<a href="#99d297d7-a36c-47e8-856e-af9bf39730fa" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="99d297d7-a36c-47e8-856e-af9bf39730fa"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@book{simo2006computational,
    author = "Simo, Juan C and Hughes, Thomas JR",
    title = "Computational inelasticity",
    volume = "7",
    year = "2006",
    publisher = "Springer Science \\& Business Media"
}
</code></pre></div></div></li></ol></div></section></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script>